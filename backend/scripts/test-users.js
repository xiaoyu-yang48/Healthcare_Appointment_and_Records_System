const mongoose = require("mongoose"); const User = require("../models/User"); async function connectDB() { try { await mongoose.connect(process.env.MONGO_URI || "mongodb://admin:123123@192.168.0.202:27017/emr?authSource=admin"); console.log("âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ"); } catch (error) { console.error("âŒ æ•°æ®åº“è¿æ¥å¤±è´¥:", error.message); process.exit(1); } } async function createTestUsers() { try { console.log("
ğŸ“ åˆ›å»ºæµ‹è¯•ç”¨æˆ·..."); const existingUsers = await User.find(); console.log(`å½“å‰æ•°æ®åº“ä¸­æœ‰ ${existingUsers.length} ä¸ªç”¨æˆ·`); if (existingUsers.length === 0) { const testUsers = [{ name: "å¼ ä¸‰", email: "zhangsan@test.com", password: "password123", role: "patient", phone: "13800138001", isActive: true }, { name: "æåŒ»ç”Ÿ", email: "doctor.li@test.com", password: "password123", role: "doctor", phone: "13800138002", specialization: "å†…ç§‘", department: "å†…ç§‘", isActive: true }, { name: "ç‹æŠ¤å£«", email: "nurse.wang@test.com", password: "password123", role: "doctor", phone: "13800138003", specialization: "æŠ¤ç†", department: "æŠ¤ç†éƒ¨", isActive: true }]; for (const userData of testUsers) { const user = new User(userData); await user.save(); console.log(`âœ… åˆ›å»ºç”¨æˆ·: ${userData.name} (${userData.email})`); } } else { console.log("ç”¨æˆ·å·²å­˜åœ¨ï¼Œè·³è¿‡åˆ›å»º"); } const allUsers = await User.find().select("-password"); console.log("
ğŸ“‹ æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨:"); allUsers.forEach(user => { console.log(`- ${user.name} (${user.email}) - ${user.role} - ${user.isActive ? "å¯ç”¨" : "ç¦ç”¨"}`); }); } catch (error) { console.error("âŒ åˆ›å»ºç”¨æˆ·å¤±è´¥:", error.message); } } async function main() { await connectDB(); await createTestUsers(); await mongoose.disconnect(); console.log("
ğŸ‰ æµ‹è¯•å®Œæˆ"); } main();
